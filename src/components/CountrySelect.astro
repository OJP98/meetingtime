---
import Search from "../icons/Search.astro";

const countries = [
  "Guatemala",
  "El Salvador",
  "United States",
  "San Salvador",
  "Buenos Aires",
];
---

<div id="search" class="dropdown w-full sm:w-fit">
  <label class="input input-bordered flex w-full items-center">
    <input
      id="search-input"
      tabindex="0"
      type="text"
      placeholder="Search your city..."
      class="grow"
      onkeyup="filterItems()"
      onclick="filterItems()"
    />
    <Search />
  </label>
  <div class="dropdown-content w-full rounded-box bg-base-200 shadow">
    <ul class="menu menu-dropdown">
      {
        countries.map((country, index) => (
          <li
            tabindex={index + 1}
            class="search-option"
            onclick="setItemValue(this)"
          >
            <button class="flex justify-between">
              <p>{country}</p>
              <p>üèÅ</p>
            </button>
          </li>
        ))
      }
      <li class="disabled" style="display: none;">
        <button>No results found</button>
      </li>
    </ul>
  </div>
</div>

<div class="divider my-0 sm:hidden"></div>

<div class="flex w-full justify-center gap-1 sm:mt-2 sm:justify-start sm:gap-2">
  <button class="btn btn-outline btn-primary btn-sm">Search</button>
  <button class="btn btn-outline btn-primary btn-sm">Zone</button>
</div>

<script is:inline>
  const input = document.getElementById("search-input");

  function displayDisabled(isDisplayed) {
    document.querySelector(".disabled").style.display = isDisplayed
      ? ""
      : "none";
  }

  function filterItems() {
    const filter = input.value.toUpperCase();
    const options = document.querySelectorAll(".search-option");
    let hits = 0;
    options.forEach((option) => {
      if (option.textContent.toUpperCase().indexOf(filter) > -1) {
        option.style.display = "";
        hits++;
      } else {
        option.style.display = "none";
      }
    });
    displayDisabled(hits === 0);
  }

  function setItemValue(element) {
    input.value = element.textContent.trim();
    document.activeElement.blur();
  }
</script>
